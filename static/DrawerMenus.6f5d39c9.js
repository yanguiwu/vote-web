import{b as D,d as g}from"./role.a9084c59.js";import{g as b}from"./util.43d19722.js";import{h as w,t as V,r as C,P as v,w as j,k as d,l as k,q as _,D as l,C as m,B,U as M,O as p}from"./element-plus.b05a9d59.js";import{_ as N}from"./index.b1bc12a8.js";const $=w({props:{formData:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,n){const{formData:u,modelValue:r}=V(e),c=C([]),a=C([]);v(async()=>{let t=await b();c.value=t,console.log("tree1",t)}),j(r,async()=>{if(r.value){a.value=[];let o=(await D(u.value.id)).data.body||[];o=o.map(y=>y.menu_code),console.log("tree2",o),a.value=o}});const s=()=>{n.emit("update:modelValue",!1)};return{treeData:c,currentNodeKey:a,handleSubmit:async()=>{await g({roleId:u.value.id,menuCode:a.value.join(",")}),M.success({message:"\u64CD\u4F5C\u6210\u529F",type:"success"}),s()},handleClose:s,onCheckChange:(t,o)=>{a.value=o.checkedKeys}}}}),F=p(" \u8C03\u6574\u6743\u9650 "),K=p("\u53D6\u6D88"),R=p("\u4FDD\u5B58");function S(e,n,u,r,c,a){const i=d("el-button"),s=d("DrawerHeader"),h=d("el-tree"),f=d("el-drawer");return k(),_(f,{modelValue:e.modelValue,"onUpdate:modelValue":n[0]||(n[0]=t=>e.modelValue=t),title:"\u8C03\u6574\u6743\u9650",direction:"rtl","before-close":e.handleClose,"destroy-on-close":"",size:"40%","with-header":!1},{default:l(()=>[m(s,null,{title:l(()=>[F]),default:l(()=>[m(i,{onClick:e.handleClose},{default:l(()=>[K]),_:1},8,["onClick"]),m(i,{type:"primary",onClick:e.handleSubmit},{default:l(()=>[R]),_:1},8,["onClick"])]),_:1}),e.treeData.length&&e.modelValue?(k(),_(h,{key:0,"default-expand-all":"","check-on-click-node":"","show-checkbox":"","highlight-current":"","expand-on-click-node":!1,"default-checked-keys":e.currentNodeKey,"node-key":"id",data:e.treeData,onCheck:e.onCheckChange},null,8,["default-checked-keys","data","onCheck"])):B("",!0)]),_:1},8,["modelValue","before-close"])}var T=N($,[["render",S]]);export{T as default};
