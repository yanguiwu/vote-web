var O=Object.defineProperty,K=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var j=(e,a,t)=>a in e?O(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,C=(e,a)=>{for(var t in a||(a={}))R.call(a,t)&&j(e,t,a[t]);if(E)for(var t of E(a))N.call(a,t)&&j(e,t,a[t]);return e},B=(e,a)=>K(e,W(a));var P=(e,a)=>{var t={};for(var s in e)R.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&E)for(var s of E(e))a.indexOf(s)<0&&N.call(e,s)&&(t[s]=e[s]);return t};import{_ as G,b as J,c as Q,a as X}from"./index.b1bc12a8.js";import{i as Y}from"./util.43d19722.js";import{h as Z,r as h,P as x,k as f,l as D,y as ee,C as o,D as l,U as v,z as F,q as A,B as k,O as y}from"./element-plus.b05a9d59.js";import{v as ae}from"./formExtend.e1564a97.js";import{e as ue,c as L,q as oe}from"./player.417f7472.js";const le=Z({props:{listData:{type:Array,default:()=>[]}},setup(){const e=h(null),a=h(null),{getStatus:t}=J(),s=Q(),d=X(),I={"x-auth-token":t.ACCESS_TOKEN},r=h([]),b=h(d.name==="voteListPlayerBetchCreate"),i="http://106.55.147.176/vote-api/sys-file/img-upload ",p=h({}),c={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0",trigger:"blur"},{max:40,message:"\u957F\u5EA6\u4E0D\u8D85\u8FC740",trigger:"blur"}]},_=u=>u.size>300*1024?(v.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 300kb!"),!1):!0,m=(u,n,g)=>{u.code===0?r.value.push(B(C({},u.body),{isHandle:!0,name:n.name})):u.code===8888&&s.push("/login")},q=u=>{r.value=r.value.filter(n=>n.id!=u.id)},z=(u,n)=>(console.log(u),!u.id||u.isHandle?!0:Y({id:u.id,actId:d.params.playerId,type:"voteSub"})),T=async()=>{if(!await ae(a)){v.error("\u8BF7\u68C0\u67E5\u5FC5\u586B\u9879\uFF0C\u5E26\u7EA2\u661F\u4E3A\u5FC5\u586B");return}if(!r.value.length){v.error("\u8BF7\u4E0A\u4F20\u56FE\u7247:");return}let u=B(C({},p.value),{imgId:r.value.map(n=>n.id).join(","),infoId:d.params.voteId});console.log("",u),d.params.playerId?await ue(u):await L(u),v.success("\u64CD\u4F5C\u6210\u529F"),s.push({name:"voteListPlayerListIndex",params:{voteId:d.params.voteId}})},$=()=>{if(!r.value.length){v.error("\u8BF7\u4E0A\u4F20\u56FE\u7247:");return}r.value.forEach(async u=>{let n=u.name.split("."),g={name:n.length?n[0]:u.id,imgId:u.id,infoId:d.params.voteId};await L(g)}),v.success("\u521B\u5EFA\u6210\u529F"),w()},w=()=>{s.push({name:"voteListPlayerListIndex",params:{voteId:d.params.voteId}})},H=async()=>{let{playerId:u,voteId:n}=d.params,S=(await oe({id:u,infoId:n})).data.body,{fileWebPath:U,imgId:V,status:Fe,createUser:he,createTime:ye,ticketNum:be,todayStar:Ee,viewNum:Ce,initialTicketNum:De,initialNum:_e,infoSeq:ge,orderTicketNum:Be}=S,M=P(S,["fileWebPath","imgId","status","createUser","createTime","ticketNum","todayStar","viewNum","initialTicketNum","initialNum","infoSeq","orderTicketNum"]);p.value=C({},M),r.value=U&&V?[{id:V,url:U}]:[]};return x(()=>{d.params.playerId&&H()}),{formData:p,formRules:c,actionUrl:i,header:I,imageUrls:r,ruleForm:a,betchUploader:e,handleSave:T,beforeAvatarUpload:_,handleAvatarSuccess:m,beforeRemove:z,onRemove:q,handleBack:w,handleBetchSave:$,isBetch:b}}}),te={class:"justify-between"},re=F("span",null,"\u521B\u5EFA\u9009\u624B",-1),se=y("\u8FD4\u56DE"),ne=y(" \u4E0A\u4F20\u56FE\u7247"),de=F("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1),ie=y("\u4FDD\u5B58"),me=y(" \u4E0A\u4F20\u56FE\u7247"),pe=F("i",{class:"el-icon-plus avatar-uploader-icon"},null,-1),ce=F("div",null," \u56FE\u7247\u683C\u5F0F\u5C3A\u5BF8\uFF1A380*300\uFF0C\u683C\u5F0Fjpg,png ",-1),fe=y("\u4FDD\u5B58");function ve(e,a,t,s,d,I){const r=f("el-button"),b=f("el-upload"),i=f("el-form-item"),p=f("el-form"),c=f("el-input"),_=f("el-card");return D(),ee("div",null,[o(_,null,{header:l(()=>[F("div",te,[re,F("span",null,[o(r,{type:"success",size:"mini",onClick:e.handleBack},{default:l(()=>[se]),_:1},8,["onClick"])])])]),default:l(()=>[e.isBetch?(D(),A(p,{key:0,ref:"ruleForm",model:e.formData,"label-width":"160px",rules:e.formRules},{default:l(()=>[o(i,{label:"\u56FE\u7247:"},{default:l(()=>[o(b,{ref:"betchUploader",accept:"image/png, image/jpeg",multiple:!0,class:"avatar-uploader",action:e.actionUrl,"on-success":e.handleAvatarSuccess,"before-remove":e.beforeRemove,"on-remove":e.onRemove,"before-upload":e.beforeAvatarUpload,headers:e.header,"list-type":"picture",name:"uploadFile"},{default:l(()=>[o(r,null,{default:l(()=>[ne,de]),_:1})]),_:1},8,["action","on-success","before-remove","on-remove","before-upload","headers"])]),_:1}),o(i,null,{default:l(()=>[o(r,{type:"primary",class:"mr-10",onClick:e.handleBetchSave},{default:l(()=>[ie]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])):k("",!0),e.isBetch?k("",!0):(D(),A(p,{key:1,ref:"ruleForm",model:e.formData,"label-width":"160px",rules:e.formRules},{default:l(()=>[o(i,{label:"\u5E97\u94FA\u540D\u79F0",prop:"name"},{default:l(()=>[o(c,{modelValue:e.formData.name,"onUpdate:modelValue":a[0]||(a[0]=m=>e.formData.name=m),size:"small",placeholder:"\u5E97\u94FA\u540D\u79F0",style:{width:"50%"}},null,8,["modelValue"])]),_:1}),o(i,{label:"\u624B\u673A\u53F7\u7801"},{default:l(()=>[o(c,{modelValue:e.formData.phone,"onUpdate:modelValue":a[1]||(a[1]=m=>e.formData.phone=m),type:"number",size:"small",placeholder:"\u7535\u8BDD",style:{width:"50%"}},null,8,["modelValue"])]),_:1}),o(i,{label:"\u5E97\u94FA\u4ECB\u7ECD",prop:"introduce"},{default:l(()=>[o(c,{modelValue:e.formData.introduce,"onUpdate:modelValue":a[2]||(a[2]=m=>e.formData.introduce=m),type:"textarea",row:4,placeholder:"\u5907\u6CE8",style:{width:"50%"}},null,8,["modelValue"])]),_:1}),o(i,{label:"\u5907\u6CE8",prop:"remark"},{default:l(()=>[o(c,{modelValue:e.formData.remark,"onUpdate:modelValue":a[3]||(a[3]=m=>e.formData.remark=m),type:"textarea",row:4,placeholder:"\u5907\u6CE8",style:{width:"50%"}},null,8,["modelValue"])]),_:1}),o(i,{label:"\u5E97\u94FA\u56FE\u7247:"},{default:l(()=>[o(b,{limit:1,multiple:!1,class:"avatar-uploader",action:e.actionUrl,"on-success":e.handleAvatarSuccess,"before-remove":e.beforeRemove,"on-remove":e.onRemove,"before-upload":e.beforeAvatarUpload,headers:e.header,name:"uploadFile","file-list":e.imageUrls,"list-type":"picture"},{default:l(()=>[e.imageUrls.length?k("",!0):(D(),A(r,{key:0,type:""},{default:l(()=>[me,pe]),_:1}))]),_:1},8,["action","on-success","before-remove","on-remove","before-upload","headers","file-list"]),ce]),_:1}),o(i,null,{default:l(()=>[o(r,{type:"primary",class:"mr-10",onClick:e.handleSave},{default:l(()=>[fe]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"]))]),_:1})])}var Se=G(le,[["render",ve]]);export{Se as default};
